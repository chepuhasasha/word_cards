# word_cards

![QR](doc/qr.svg)

Учебное веб-приложение для заучивания корейских слов по карточкам. Поддерживает встроенные наборы, загрузку собственных словарей, три режима изучения и сохранение избранного прямо в браузере.

## Возможности

- **Режимы "Учить", "Тест" и "Напиши"**: просмотр перевода и описания, проверка вариантов ответов или ввод слова с клавиатуры.
- **Плавная навигация**: переключение карточек стрелками, Enter или свайпами, цикличный обход списка.
- **Работа с избранным**: добавление/удаление текущего слова, фильтрация по избранному, постоянное хранение в `localStorage`.
- **Горячие клавиши**: цифры 1–4 для выбора вариантов, стрелки для навигации, пробел — добавить в избранное (в режиме просмотра/теста).
- **Аудиосопровождение**: встроенные дорожки для слов, автоматическое воспроизведение в режимах "Учить"/"Тест" и отдельный плеер.
- **Выбор сета слов**: предустановленные JSON-наборы из `src/assets/sets`, модальное окно выбора, сортировка по диапазонам.
- **Загрузка пользовательских словарей**: импорт JSON с полями `word`, `translation`, `audio`, опционально `transcription` и `description`.
- **Подсказки интерфейса**: визуализация активных клавиш, индикатор прогресса и счетчики изученных слов.

## Быстрый старт

1. Установите Node.js версии `^20.19.0` или `>=22.12.0`.
2. Установите зависимости: `npm install`.
3. Запустите дев-сервер: `npm run dev` и откройте ссылку из терминала.

## Скрипты npm

| Команда                                  | Назначение                                                            |
| ---------------------------------------- | --------------------------------------------------------------------- |
| `npm run dev`                            | Запуск Vite в режиме разработки с горячей перезагрузкой.              |
| `npm run build`                          | Предсборка аудио и production-сборка (type-check → build).            |
| `npm run preview`                        | Предпросмотр собранного приложения.                                   |
| `npm run type-check`                     | Проверка типов через `vue-tsc`.                                       |
| `npm run lint`                           | ESLint + Stylelint с автоисправлениями.                               |
| `npm run format`                         | Prettier + Stylelint для форматирования кода и стилей.                |
| `npm run test` / `npm run test:coverage` | Тесты через Vitest (обычный режим или с покрытием).                   |
| `npm run audio`                          | Генерация/обновление аудио-файлов для словарей из `scripts/audio.js`. |

## Стек и архитектура

- **Frontend**: Vue 3 (Composition API, `<script setup>`), TypeScript, Pinia для состояния, Vite для сборки.
- **Стили и качество**: ESLint, Stylelint, Prettier, TypeScript strict, Vitest и Testing Library для компонентных тестов.
- **Данные**: JSON-наборы слов (`word`, `translation`, `audio`, `transcription?`, `description?`), аудио лежит в `public/audio`.
- **Хранилище**: Pinia-стор `useWordsStore` управляет режимами, списками слов, вариантами ответов, любимыми карточками и навигацией.
- **Композиционные хуки**:
  - `useEmbeddedSets` — собирает встроенные наборы, открывает модальное окно выбора и применяет выбранный сет.
  - `useDictionaryUpload` — позволяет выбрать и загрузить пользовательский JSON словаря.
  - `useKeyboardShortcuts` — назначает горячие клавиши, подсвечивает активные и дергает методы стора.
  - `useDeviceType` / `useSwipeNavigation` — детектируют тип устройства и свайпы для мобильной навигации.

### Поток данных

1. Пользователь выбирает встроенный сет или загружает JSON — данные передаются в `useWordsStore.setWords`.
2. Стор перемешивает список, выставляет текущее слово и варианты ответов (для режима теста).
3. Компоненты (`WordDisplay`, `AnswerSection`, `AudioPlayer`, `WordCounter`) читают реактивное состояние и отображают UI.
4. Действия (клики, горячие клавиши, свайпы) вызывают методы стора (`next`, `prev`, `check`, `checkWrite`, `toggleFavorites`), обновляя состояние и localStorage.

## Структура каталогов

```
/                           Корень проекта (Vite + Vue)
├─ public/                  Статические файлы и аудио дорожки
├─ scripts/                 Утилиты сборки аудио (`audio.js`)
├─ src/
│  ├─ assets/sets/          Встроенные JSON-наборы слов
│  ├─ components/           UI-компоненты (WordDisplay, AnswerSection, AudioPlayer и др.)
│  ├─ composables/          Переиспользуемые хуки (горячие клавиши, загрузка сетов, свайпы)
│  ├─ stores/               Pinia-сторы (основной — `useWordsStore`)
│  ├─ types/                Типы доменной модели (`Word`, `EmbeddedSet`)
│  └─ main.ts, App.vue      Точка входа и композиция страницы
├─ tests/                   Юнит- и компонентные тесты Vitest/Testing Library
└─ vite.config.ts           Конфигурация сборки
```

## Формат словаря

Каждая карточка — объект формата:

```json
{
  "word": "안녕",
  "translation": "привет",
  "audio": "/audio/annyeong.mp3",
  "transcription": "annyeong",
  "description": "Неофициальное приветствие"
}
```

Обязательные поля — `word`, `translation`, `audio`. Остальные опциональны и отображаются в режимах просмотра/обучения.

## Работа с аудио

- Скрипт `scripts/audio.js` принимает путь к директории с JSON-наборами (по умолчанию `src/assets/sets`) и опциональный флаг `--rewrite-audio`, скачивает дорожки через Google Translate TTS и сохраняет их в `public/audio`.
- `npm run build` и `npm run audio` автоматически вызывают скрипт для актуализации аудио перед сборкой.

## Тестирование и контроль качества

- ESLint и Stylelint запускаются через `npm run lint`, форматирование — `npm run format`.
- TypeScript-проверка (`npm run type-check`) и тесты (`npm run test` или `npm run test:coverage`) помогают гарантировать корректность логики и UI.
